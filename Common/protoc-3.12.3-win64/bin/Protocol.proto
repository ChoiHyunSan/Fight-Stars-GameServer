syntax = "proto3";

package Protocol;
import "google/protobuf/timestamp.proto";
option csharp_namespace = "Google.Protobuf.Protocol";

enum MsgId {
  C_ENTER_ROOM = 0;
  S_ENTER_ROOM = 1;
  C_READY_COMPLETE_GAME = 2;
  S_READY_COMPLETE_GAME = 3;
  C_MOVE = 4;
  S_POSITION_UPDATE = 5;
}

message C_EnterRoom {
  string roomId = 1;
  string password = 2;
  string nickname = 3;
  int32 userId = 4;
}

message S_EnterRoom {

  EnterResult enterResult = 1;
  int32 playerCount = 2;
  repeated PlayerInfo playerInfos = 3;

  enum EnterResult {
    SUCCESS = 0;
    INVALID_ID = 1;
    ACCESS_DENIED = 2;
    ALREADY_IN_ROOM = 3;
  }

  message SpawnPos {
    int32 x = 1;
    int32 y = 2;
  }

  message PlayerInfo {
    int32 userId = 1;
    int32 skinId = 2;
    int32 characterId = 3;
    string nickname = 4;
    SpawnPos spawnPos = 5;
  }
}

message C_ReadyCompleteGame {
  int32 userId = 1;
}

message S_ReadyCompleteGame {
  google.protobuf.Timestamp startTime = 1;
}

message C_Move{
    int32 userId = 1;
    float dx = 2;
    float dy = 3;
}

message S_PositionUpdate{
    
    repeated PlayerPosUpdate playerPosUpdates = 1;

    message PlayerPosUpdate{
        int32 userId = 1;
        float x = 2;
        float y = 3;
        float vx = 4;
        float vy = 5;
    }
}